# Gopher Sauce Server Generation
![Implies that Gopher sauce uses Go to write go programs.](https://lh3.googleusercontent.com/-vnw4NhuJKQY/VmuZgzodIPI/AAAAAAAAAAM/mbm7EfWjfsY/s0/xlarge.png "xlarge.png")

Gopher Sauce is is a command line tool used for compiling GoS projects. A GoS project uses XML sources and Go lang packages to create a web server (one Go src file with package main). It uses xml to build onto Go lang's [template](https://golang.org/pkg/html/template/)  processing functionality, making it easier to define custom objects,methods and structs that are accessible to your templates and even api endpoints for your web server.
Gopher Sauce makes web server application distribution easy by compiling your entire Gopher Sauce application's sources and misc. file resources into one binary. 

### How to install GoS
	go get -u github.com/cheikhshift/gos/...

### Handle GoS Dependencies
The application generated by Gopher Sauce has certain dependencies. Please run the command below to download them. (Assuming $GOPATH is set)

	$GOPATH/bin/gos dependencies

# Table of Content

 1. [GoS XML template](#gos-xml-template)
 2. [GoS project layout](#gos-project-layout)
 3. [Core Usage](#core-usage) 
	 1. Using GoS command without parameters
	 2. GoS running application
	 3. GoS export application 
 4. Configuring GoS xml file
	1. Deploy
	2. Port
	3. Output
	4. Key
	5. Init
	6. Main
	7. Var
	8. Header
		1. Structs
		2. Objects
9. Methods
10. Timers
11. Templates
12. API Generation 
13.  Imports
 5. Bug tracking

# GoS XML template
The GoS XML template is where your application declarations are saved. Here is a fully documented project template [file](https://github.com/cheikhshift/Gopher-Sauce/blob/master/src/github.com/cheikhshift/gosapphire/server.xml)

 Below is an example of a very minimal GoS XML source : 
This Example will save a file named server_out.go to the specified package in the gos cmd tool. It will create one struct called DemoChild in the native go manner.

	 <?xml version="1.0" encoding="UTF-8"?>
	<gos>
		<deploy>webapp</deploy>
		<port>8080</port>
		
		<output>server_out.go</output>
	
		<key>something-secretive-is-what-a-gorrilla-needs</key>
		<header> 
			<!-- remember to Jumpline when stating methods or different struct attributes, it is vital for our parser \n trick -->
		<struct name="DemoChild">
			SomeOtherAttr string
		</struct>
		</header>
	</gos>

# GoS project layout
This section covers the integration if GoS with your current GoS configuration. GoS project minimally requires a GoS XML template, a web root folder and a template root folder.

 - Template folder is the root folder for all templates declared within your application
 - Web root can contain both usual server data and template pages as well. Template pages within the  web root folder have access to user sessions.
	 - *webroot/dist/ is initialized as a fileserver to correct issues when serving css files.

Your GoS project should look like this
		
		$GOPATH/src/
			|-	your/package/name
							|-		gos_xml_template.xml
							|-		web_root/
										|-	index.html
									template_root/
										|-	email.tmpl 
	

# Core Usage
This section covers how to use the command line tool

## Using GoS command without parameters
It is possible to invoke gos directly without commands. Simply answer the questions and watch your application compile.

	$GOPATH/bin/gos
## GoS running application
To compile and run your GoS application invoke `gos` with the run parameter.
For example to compile a package called `sample/test` with configuration file 	`server.xml`, a web root folder called `web` as well as a templates directory called  `tmpl` 
		
*Command of process described
	 $GOPATH/bin/gos run sample/test server.xml web tmpl
	 
The command above should compile and execute your program. Invoking the `gos` with the run parameter will put go-bindata in -debug mode so that you can edit your server files while your application is in debug
## GoS export application
Exporting your application will wrap up all of your GoS project sources as one binary ready for distribution. To compile and export your GoS application invoke `gos` with the export parameter.
For example to export a package called `sample/test` with configuration file 	`server.xml`, a web root folder called `web` as well as a templates directory called  `tmpl` 
*Command of process described
	
	$GOPATH/bin/gos export sample/test server.xml web tmpl

Unlike running the GoS application, this build will have static copies of its resources at the time of compilation. The executable will be placed in your GoS project root (package root). This copy can be ran anywhere without the need of resources within your package.

# Configuring GoS XML file
This section covers documentation of GoS XML template tags

## Deploy
Application deploy specifies the manner that GoS should compile your application. Use `webapp` to have GoS generate a webserver for you. This tag should always be within the root of the `<gos/>` tag.
*This tag is required

	<gos>
		...
		<deploy>webapp</deploy>
		...
	</gos>
		
## Port
(if applicable) Specifies the port your application should listen on. 

	<gos>
		...
		<port>8080</port>
		...
	</gos>
## Output
The name of the file that GoS will save.
*This tag is required
	
	<gos>
		...
		<output>server_out.go</output>
		...
	</gos>
## Key

(if applicable) used as cookie store key within web app

	<gos>
		...
		<key>my-key-braah</key>
		...
	</gos>
## Init
GoS will wrap the data within this tag into the usual Go `init()` function
For example :
		
		<gos>
			...
			<init> 
				fmt.Println("Logging from init function")	
			</init>
			...
		</gos>
Will translate into

	func init(){
		fmt.Println("Logging from init function")
	}
This can be useful for registering custom declared structs for Session use.

## Main
GoS will wrap the data within this tag into the go `main()` function.
For example : 

		<gos>
			...
			<main> 
				fmt.Println("Logging from main function")	
			</main>
			...
		</gos>
Will translate into

	func main(){
		...
		fmt.Println("Logging from Main function")
		...
	}


## Variables
To declare public variables that are accessible to your program use the `var` tag. Use the type parameter to specify the variable type. Use the `*` qualifier as appropriate.
For example 

		<var type="string">FreeServer</var>
Will become (within your Go program)

		var FreeServer stromg 
## Header
Think of the `<header/>` tag as the interface of your application. It holds structure and object declarations.
### Structs
The `<struct/>` tag will declare a new Go structure within within your generated Go src.
#### Attributes
name - The name of this structure

The example below declares a Go struct named DemoGos with a sub structure called DemoChild. The struct DemoGos has attributes SomeAttr and Child. Whenever this struct is initialized within a template, these variables are accessible.

	<gos>
		...
		<header>
			<struct name="DemoChild">
				SomeOtherAttr string
			</struct>
			<struct name="DemoGos">
				SomeAttr string
				Child *DemoChild
			</struct>
		</header>
		...
	</gos>
### Objects
The `<object/>` tag declares a GoS object. It needs struct parameter map, which is used whenever this object is initialized within a template. Please keep in mind that the struct specified for this object must be returned all the time.
#### Attributes
	struct - the name of a struct available to the application
	name - name of object
The example below will declare an object called `myDemoObject`. The inner content of this tag is where object methods are declared. (remember to jumpline after each declaration!!!) These functions also need to be declared within your GoS application xml template or another included template.
 

	<gos>
		...
		<header>
		<object struct="DemoGos" name="myDemoObject">
			Hackfmt(save string)
			WhatsMyAttr(save string,end string) string
			WhatsMyAttrLength() string
		</object>
		</header>
		...
	</gos>
By declaring an object :
 - GoS will create a type with the object's name linked its respective struct
 - GoS will create a local and template accessible method to initialize this object. Local method :  `net_myDemoObject(args ...interface{}) (d DemoGos)`. Template method : {{$emptyObject :=  myDemoObject}}.

-  Invoking object with static parameters : `{{$object := myDemoObject /{`\`SomeAttr\`:\`ValueIn\`}/ }}`. To pass initialization variables we can use a static json escape holders `/{` and `}/`. To initialize your variable with other objects create a method that returns this object by using the desired input initialization object to use.

- For each function specified within this tag will be generated to accept this object as a mutable parameter within templates as well as your application's local scope. Local function generated :
 `	func (object DemoGos) Hackfmt(save string) `
 You can access this function via templates by invoking these calls within any template in this application : `{{$object | Hackfmt "data"}}` or `{{$error := $object | Hackfmt "data" }}`. The return type declared will be returned, so please make sure that type is returned within the linked method.

*If an Object and a template share a struct you can initialize the template with this call `{{b<template name> $object}}`





## Imports
Imports allow you to import other Go lang packages for use within your GoS XML template. It also allows you to import other GoS xml template by specifying an XML file relative to `$GOPATH/src`. This will include that files imports either template files or Go lang packages, structs,objects,methods,timers,templates and api endpoints. 

This tag belongs only in the root of the `<gos/>` tag
Example import :
		
		<import src="mongo.xml"/>
		<!-- Importing Golang Packages -->
		<import src= "gopkg.in/mgo.v2"/>
		<import src="gopkg.in/mgo.v2/bson"/>

