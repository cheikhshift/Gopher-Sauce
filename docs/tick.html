<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>GohperSauce - Tick project</title>
    <!-- Bootstrap CSS -->
<script src="https://use.fontawesome.com/d102afacbe.js"></script>
 
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="../main.css">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
          <link rel="stylesheet" href="//cdn.jsdelivr.net/jquery.sidr/2.2.1/stylesheets/jquery.sidr.dark.min.css">
  </head>
  <body>

   
    <nav class="navbar navbar-light bg-primary navbar-fixed-top" >
  <button class="navbar-toggler hidden-sm-up" type="button" data-toggle="collapse" data-target="#exCollapsingNavbar2">
    &#9776;
  </button>

   <div class="collapse navbar-toggleable-xs" id="exCollapsingNavbar2">
  
  <ul class="nav navbar-nav">

    <li class="nav-item">
      <a class="nav-link" href="../"><i class="fa fa-home"></i> Home</a>
    </li>
        <li style="margin-right: 12px;" class="nav-item">
       <a class="nav-link" href="docs/projects.html"><i class="fa fa-user-circle"></i> Projects</a>
    </li>
    <li style="margin-right: 12px;" class="nav-item">
       <a class="nav-link" href="index.html"><i class="fa fa-book"></i> Docs</a>
    </li>
       <li style="margin-left: 12px;" class="nav-item">
      <a class="nav-link" href="https://github.com/cheikhshift/Gopher-Sauce/wiki"> Wiki</a>
    </li>

     <li style="margin-right: 12px;" class="nav-item">
       <a class="nav-link" href="https://github.com/cheikhshift/Gopher-Sauce"><i class="fa fa-github"></i> Github</a>
    </li>

      <li style="margin-right: 12px;" class="nav-item">
       <a class="nav-link" href="https://www.orkiv.com/project-submission/"><i class="fa fa-building"></i> Enterprise</a>
    </li>

  </ul>
  <div class="form-inline pull-xs-right">
    <a href="#" class="btn btn-warning-outline btn-block" type="submit">Top</a>
  </div> 
</div>
</nav>

  <div class="header-space" style="height:190px;margin-bottom:2em;">
      <div class="cont container">
          <div class="page-header">
              <h1 style="color:#fff" class="tect">Tick : Realtime data from MongoDB</h1>
          </div>
      </div>
  </div>
  <div class="container">
        <div class="list-group list-group-item">
            
          

<p><img src="https://cdn.xl.thumbs.canstockphoto.com/canstock22242451.jpg" alt="" />
<img src="https://camo.githubusercontent.com/ed1230a48b6946283ee0d76185a726b49ba58254/68747470733a2f2f7472617669732d63692e6f72672f746f6f6c732f676f6465702e737667" alt="enter image description here" /></p>


<p>Tick project tracks realtime data from your Mongo database to your client's browser. This is possible with the help of web sockets <code>ws://</code></p>

<h1 id="howtouseit">How to use it</h1>

<p>Ticker supports templates by default. To use a Template function  within your <code>gos</code> app functions add the prefix <code>net_&lt;function name&gt;</code> to your function name.</p>

<p>Tick <a href="https://github.com/cheikhshift/tick-tutorial">Sample</a> project.</p>

<h3 id="importtickerframework">Import Ticker package</h3>

<pre><code>&lt;import src="github.com/cheikhshift/tick/gos.gxml"/&gt;
</code></pre>

<h3 id="initandsetmongodb">Init and set MongoDB</h3>

<p>Add this snippet within your <code>&lt;main&gt;</code> tag. Copy the whole snippet if you're GohperSauce project has no main tag.</p>

<pre><code>    &lt;main&gt;  
    //Tick encryption key   
    tick.Key = "example key 1234"
    //HostName string syntax [host]:[port]
    // var HostName string included on tick/gos.gxml import
    HostName = "localhost:8080"
    // dbs included on tick/gos.gxml import
    dbs,_ = db.Connect("localhost", "database")
    tick.SetDb(dbs)
    &lt;/main&gt;
</code></pre>

<h3 id="declaredbobjectpipeline">Create DB Object pipeline</h3>

<p>Struct of <code>dbObject</code>. This Struct will be made available on <code>tick</code> import (no redeclaration required) :</p>

<pre><code class="html golang">    &lt;struct name="dbObject"&gt;
        Id bson.ObjectId `bson:"_id,omitempty"`
        Created time.Time
        Track int
        Signature string `valid:"unique"`
    &lt;/struct&gt;
</code></pre>

<p>Add a new <code>method</code> within your <code>&lt;methods&gt;</code> tag (in GohperSauce). Replace dbObject with your own model. 
This snippet will find any database object :</p>

<pre><code class="html golang">    &lt;method name="GetdbObject" return="dbObject"&gt;
        dbo := dbObject{}
        dbs.Q(&amp;dbo).Find(nil).One(&amp;dbo)
        return dbo
    &lt;/method&gt;
</code></pre>

<h3 id="template">Template</h3>

<p>With the prior section in mind, this is how you track your database object's values. Within your templates on GohperSauce use the following code.</p>

<p>Get object via pipeline : </p>

<pre><code>{{ $item := GetdbObject }}
</code></pre>

<p>Open socket to item :</p>

<pre><code>{{ Tick $item }}
</code></pre>

<p>(optional) Display live value of object key. (Any struct field must be in lower case) : </p>

<pre><code>{{ Watch $item "track" }}
</code></pre>

<p>Syntax :</p>

<pre><code>{{ Watch mongo_database_object_interface field_string }}     
</code></pre>

<h1 id="javascriptapi">Javascript API</h1>

<p>Prior to calling each of the JS functions, remember to invoke {{Tick database_object }} to load the API.
Follow this syntax to create event handlers for your object : </p>

<pre><code class="html">    &lt;script&gt;
     //Tick Js function
     Tick({{ IdOf $item }} , function(data){
             console.log("Update")
     })
     &lt;/script&gt;
</code></pre>

<p>JS function : Tick(id string , callback function(data) )</p>

<ul>
<li>id : ID of database item.</li>

<li>callback : function called on each update.</li>
</ul>

<h3 id="detectwebsocketcloseonclient">Detect websocket close on client :</h3>

<pre><code class="html">&lt;script&gt;
    $tick.close = function(event ) {
        console.log(event)
    }
&lt;/script&gt;
</code></pre>
         
        </div>
  </div>



  <footer>
    <div class="container">
      <h5 style="float:right;" class="text-muted">&copy 2017 Cheikh Seck</h5>
     
      <ul class="nav nav-inline">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/cheikhshift/Gopher-Sauce"><i class="fa fa-github"></i> Github</a>
        </li>
      </ul>
    </div>
  </footer>
    
    <!-- jQuery first, then Bootstrap JS. -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/js/bootstrap.min.js" integrity="sha384-vZ2WRJMwsjRMW/8U7i6PWi6AlO1L79snBrmgiDpgIWJ82z8eA5lenwvxbMV1PAh7" crossorigin="anonymous"></script>
    <script type="text/javascript" src="../js/okshadow.js"></script>
     <script src="//cdn.jsdelivr.net/jquery.sidr/2.2.1/jquery.sidr.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

    <script type="text/javascript">
        $(function(){
        $('.head').okshadow({color:"rgba(0,0,0,0.4)"});
         $('.tect').okshadow({textShadow:true,color:"rgba(0,0,0,0.4)"});
        });
        
         hljs.initHighlightingOnLoad();
    </script>
     <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-71342160-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>
  </body>
</html>
